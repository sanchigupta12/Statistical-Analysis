---
title: "Module 5"
author: "Sanchi Gupta"
date: "`r Sys.Date()`"
output: html_document
---


# Module 5 R Practice
### 1. Reading the dataset into R
```{r}
property <- read.csv("fy2023-property-assessment-data copy.csv")
```

### 2. Preparing the dataset
* #### Importing Libraries
```{r}
library(janitor)
library(tidyverse)
library(corrplot)
library(broom)
library(kableExtra)
```

* #### Cleaning the col names 
```{r}
property <- clean_names(property)
```

* #### Replacing outliers
```{r}
#creating a function to filter outliers
filter_outliers <- function(x) {
  quantile1 <- quantile(x, 0.25, na.rm = TRUE)
  quantile3 <- quantile(x, 0.75, na.rm = TRUE)
  iqr_value <- IQR(x, na.rm = TRUE)
  
  lower_values <- quantile1 - 1.5 * iqr_value
  upper_values <- quantile3 + 1.5 * iqr_value
  
  outliers_removed <- ifelse(x < lower_values | x > upper_values, NA, x)
  x_cleaned <- ifelse(is.na(outliers_removed), median(x, na.rm = TRUE), outliers_removed) 
  
                    return(x_cleaned)
}

# Clean all numeric columns in the dataset
property_df_cleaned <- property %>%
  mutate(across(where(is.numeric), filter_outliers))

# Remove rows with any NA values after cleaning
property_df_cleaned <-na.omit(property_df_cleaned)

```

### 3. Part 1- Correlation Analysis
```{r}
# Extracting useful cols
part_1 <- subset(property, select= 
                        c(land_value ,living_area, bldg_value, land_sf, gross_tax))

# Remove rows with any NA values after cleaning                    
part_1_cleaned <-na.omit(part_1)    

# Correlation analysis
correlation_table1 <- cor(part_1_cleaned)

# Plotting correlation matrix
corrplot(cor(correlation_table1), 
         method = "number",
         type = "upper",
         order = "hclust",
         tl.col = "black",
         tl.srt = 45, 
         addrect = 3 )
```

#### Analysis of Correlation Matrix Heatmap:

* **Correlation Coefficients:** 
The numbers in each cell represent the Pearson correlation coefficient between the variables indicated by the corresponding row and column. These coefficients range from -1 to 1, 
where:

 a. 1 indicates a perfect positive linear relationship.
 b. -1 indicates a perfect negative linear relationship.
 c. 0 indicates no linear relationship.


* **Color Scale:** 
The color scale on the right side of the heatmap indicates the strength and direction of the correlation. In this scale:
a. Shades of blue represent positive correlations.
b. Shades of red represent negative correlations.
The intensity of the color corresponds to the strength of the correlation (darker colors signify stronger correlations).


* **Significant Correlations:**

a. land_sf and gross_tax have a strong negative correlation of -0.94, suggesting that as land square footage increases, the gross tax tends to decrease significantly.
b. land_sf and bldg_value also have a strong negative correlation of -0.82.
c. land_value and living_area show a strong positive correlation of 0.85, which indicates that properties with higher land values tend to have larger living areas.

-----

#### Why a correlation chart should not be larger than 5 variables for reporting purposes?

* **Visual Clarity:** Including too many variables in a correlation chart can result in a cluttered and complex visual representation. It becomes challenging for readers to interpret and derive meaningful insights when the chart is overcrowded.

* **Interpretability:** With a smaller number of variables, the relationships and patterns in the data become more interpretable. 

* **Communication Effectiveness:** In a reporting context, simplicity enhances communication effectiveness. Decision-makers and stakeholders may not have the time or expertise to navigate through a complex chart, so a concise representation aids in conveying essential information efficiently.

* **Avoiding Misinterpretation:** Including too many variables can lead to misinterpretations for conclusions. Limiting the variables reduces the risk of readers drawing incorrect inferences or overlooking crucial correlations.


-------

### 4. Part 2 - Regression Analysis
```{r}
# Extracting useful columns
part_2 <- subset(property_df_cleaned, select = c(bldg_value, land_sf, land_value, total_value))

# Remove rows with any NA values after cleaning
part_2_cleaned <- na.omit(part_2)

# Fit the regression model
part_2_rm <- lm(total_value ~ bldg_value + land_value + land_sf, data = part_2_cleaned)

# Extract regression results
regression_results <- tidy(part_2_rm)

# Round p-values to 4 decimal places
regression_results$p.value <- round(regression_results$p.value, digits = 15)

# Print regression results
kable(regression_results, caption = "Multiple Linear Regression Results") %>%
  kable_styling(bootstrap_options = "striped", full_width = FALSE)

```

* **Total_value (Intercept):**
The intercept represents the expected value of the response variable (total_value) when all predictor variables (bldg_value, land_value, land_sf) are zero. The p-value of 0 suggests that the intercept is statistically significantly different from zero.

* **bldg_value:**
The estimate indicates that a one-unit increase in bldg_value is associated with an increase of approximately 0.94479 units in total_value. The p-value of 0 suggests that bldg_value is statistically significantly related to total_value.

* **land_value:**
The estimate for land_value indicates the expected change in total_value for a one-unit increase in land_value. The p-value of 0 suggests that land_value is statistically significantly related to total_value.

* **land_sf:**
The estimate for land_sf indicates the expected change in total_value for a one-unit increase in land_sf. The p-value of 0 suggests that land_sf is statistically significantly related to total_value.


In summary, all predictors (bldg_value, land_value, land_sf) have p-values of 0, indicating strong evidence against the null hypothesis of no association with total_value. This suggests that each predictor is statistically significantly related to the dependent variable, total_value. The t-statistics are very large, further supporting the statistical significance of these relationships. The estimates provide the expected change in total_value associated with a one-unit increase in each predictor, holding other predictors constant.

------

#### How does regression analysis differ from correlation analysis?

* **Purpose:**
Correlation Analysis quantifies the degree to which changes in one variable are associated with changes in another variable. Regression Analysis models the relationship between a dependent variable and one or more independent variables. It aims to predict the value of the dependent variable based on the values of the independent variables.


* **Nature of Analysis:**
Correlation Analysis describes the association between variables without implying causation. 
Regression Analysis provides a predictive model that estimates the relationship between variables. 

* **Output:**
Correlation Analysis outputs a correlation coefficient, often ranging from -1 to 1. The sign indicates the direction (positive or negative), and the magnitude indicates the strength of the correlation.
Output of Regression Analysis regression coefficients for each independent variable, an intercept, and statistical measures such as R-squared, which indicates the proportion of variance explained by the model.

* **Application:**
Correlation Analysis is suitable for exploring associations between variables, identifying patterns, and guiding further research. Whereas Regression Analysis is used for prediction, hypothesis testing, and understanding the relationship between variables in a more detailed and quantitative manner.

------